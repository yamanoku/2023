---
title: button要素のtype属性について気にしたくないけどそうもいかなそうな話
description: button要素のマークアップについて神経質な人の話です
date: 2023-12-04
author: yamanoku
---

この記事は[yamanoku Advent Calendar 2023](https://adventar.org/calendars/8589)の4日目の記事になります。

皆さんは`button`要素を書く時に`type`属性を書くこと気にしてますか？私は気にしてます。気にしすぎているほどに。

## なぜ気にしているのか

`button`要素には`type`属性があります。この`type`属性はデフォルトの値が`submit`になっています。送信目的じゃないインタラクション目的（例えば要素を開閉するなどの挙動）の`button`要素を書くときは`type`属性を`button`とする必要があります。その他にもフォーム内容をリセットさせる`reset`という値もあります。

```html
<button type="submit">送信する</button>
<button type="button">開閉する</button>
<button type="reset">リセットする</button>
```

この指定がない場合に困る問題としてコンポーネントとして扱っている際に親要素に`form`要素があると送信ボタンとして認識されて実装時に予期せぬ挙動になることがあります。

> alertを出したあと一旦console.logするだけにしたのですが<br>
> なぜか画面がリロードされてしまう。。。（URLの最後に?がつくのでget通信しようとしているようにみえる）
>
> [buttonタグで勝手にリロードされてしまう(vue.js) #JavaScript - Qiita](https://qiita.com/haruraruru/items/53614e739437bf7e5b1c)

> これ、ひとつのコンポーネントの template で form と button が同時に出てきていたら比較的探しやすいんだけど、コンポーネントが入れ子になっているとかなり見つけにくいということが分かった。
>
> [buttonタグで勝手にリロードされてしまう問題](https://random.tagucch.dev/posts/2021-10-19)

この挙動自体はHTMLの挙動になるのですが、JavaScriptと一緒に扱っている場合はどこに問題があるのか一見してわからなくなる可能性があります。そうしたヒューマンエラーを防ぐためにも`type`属性を明示的に指定することが重要だと思っています。

ただし以下のように`form`要素の中で使う場合は送信ボタンとして自明なのでその場合は`type`を省略しても問題ないと思っています。

```html
<form method="post">
  <label>
    名前
    <input name="submitted-name" autocomplete="name" />
  </label>
  <button>保存</button>
</form>
```

> [\<form>: フォーム要素 - HTML: ハイパーテキストマークアップ言語 | MDN](https://developer.mozilla.org/ja/docs/Web/HTML/Element/form)

## サンプルコードで`type`属性が省略されている問題

技術ブログやドキュメントなどのサンプルコードで`type`属性が省略されていることがあります。私はよくそうしたものを目にしてしまうこともあってか、そのことが気になってしょうがありません。

以下はSWRのブログ記事のサンプルコードです。`type`属性が省略されています。

```jsx
const { mutate, data } = useSWR('/api/todos')

return <>
  <ul>{/* Display data */}</ul>
  <button onClick={() => {
    mutate(addNewTodo('New Item'), {
      optimisticData: [...data, 'New Item'],
    })
  }}>
    Add New Item
  </button>
</>
```

> [Announcing SWR 2.0 – SWR](https://swr.vercel.app/blog/swr-v2)

こうした代表的なライブラリのサンプルコードに`type`属性が省略されていることは、`type`属性を省略しても問題ないと錯覚させてしまうかもしれないので個人的には好ましくありません。

もちろん明示的に`type`属性を示しているものもあります。Preactのチュートリアルでは`submit`を明示しています。この例はとても良いので見習ってほしいです。

```jsx
import { h, render, Component } from 'preact';

class App extends Component {
  render() {
    return (
      <div>
        <h1>Hello, world!</h1>
        <form>
          <input type="text" />
          <button type="submit">Update</button>
        </form>
      </div>
    );
  }
}

render(<App />, document.getElementById('app'));
```

> [Tutorial | Preact: Fast 3kb React alternative with the same ES6 API. Components & Virtual DOM.](https://preactjs.com/guide/v10/tutorial/)

それはそれとして`<input type="text">`にラベルが紐づけていないのが気になります。

## Linterで`type`属性をつけるよう矯正する

このような属性に関する指摘をいちいちレビュー等で毎度指摘するのは大変なので、できるかぎり機械的に指摘するようにしてもらいたいです。

そこで業務でも私用でも愛用しているマークアップのリンターである[Markuplint](https://markuplint.dev/ja/)では以下のように`type`属性をつけるように強制しています。

```json
{
  "rules": {
    "required-attr": true,
  },
  "nodeRules": [
    {
      "selector": "button",
      "rules": {
        "required-attr": {
          "value": [
          {
            "name": "type",
            "value": ["button", "reset", "submit"]
          }
        ],
        "reason": "type 指定がないとデフォルトで submit の挙動になるので、予期せぬ挙動にならないように意図的に提示してください。"
      }
    }
  ]
},
```

AngularのESLintでは`button`要素に`type`属性がないと警告がでるルールが搭載されています。これはとても良いものですね。

[angular-eslint/packages/eslint-plugin-template/docs/rules/button-has-type.md at main · angular-eslint/angular-eslint](https://github.com/angular-eslint/angular-eslint/blob/0fd361abb7ba80d908e7abdc1e038974366cf72c/packages/eslint-plugin-template/docs/rules/button-has-type.md)

## `form`要素を使わなくてもデータ送信ができるようになった

しかし`button`要素の`type`属性を意識するのは`form`要素を使う時だけなのかもしれません。事実、現在サーバーにデータを送信するために`form`要素を使わなくても`JavaScript`を経由して送信することができます。

JavaScriptでHTTPリクエストを送るオブジェクトであるXMLHTTPRequestを使うことで可能になります。

```js
const xhr = new XMLHttpRequest();
xhr.open('POST', '/api/todos');
xhr.setRequestHeader('Content-Type', 'application/json');
xhr.send(JSON.stringify({ title: 'New Item' }));
```

Fetch APIを使う場合でも同様のことが可能になります。

```js
fetch('/api/todos', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({ title: 'New Item' }),
});
```

このように`form`要素を使わなくてもデータを送信できるようになってきています。JavaScriptとWeb APIの進化により送信するための責務がHTMLから離れてきており、`<button type="submit">`を意識することは減ってきてしまっているのかと私は推測しています。

しかし最近ではRemixやReact.jsからServer Actionといったものが生まれてきて、JavaScript（この場合はJSX）を書きつつも`form`要素でデータ送信を扱う事例も増えてきています。

これはハイドレーションが完了するまでにフォーム操作ができるようになるユーザー体験としての利点がありますが、そもそもデータを送信するセマンティクス情報として`form`要素を意識して書くことができるのであれば、フレームワークに準じて書くべきだと思っています。

## `button`自体が扱いやすいものになってきている

ところでいまWebブラウザ上で「ボタン」を表現する際に`button`要素を使う人が多いと思っています。

HTML仕様上では`input`要素の`type`属性で`button`を指定することも同等の挙動になります。要素としては`button`の方が後で生まれたもの（[HTML4.0](https://www.w3.org/TR/html40/interact/forms.html#h-17.5)より）になります。

```html
<!-- 以下２つは挙動としては妥当なマークアップ -->
<input type="button" value="お気に入りに追加" />
<button type="button">お気に入りに追加</button>
```

`input`要素の`type`属性で`button`を指定すると`value`属性の値がボタンのラベルになります。`button`要素では中身のテキストがボタンのラベルとなります。

ですがボタンの中で画像やアイコンを差し込むことを想定した場合は`button`要素のほうが圧倒的に扱いやすいでしょう。

```html
<button type="button">
  <svg width="20" height="20" viewBox="0 0 100 100" role="img" aria-hidden="true">
    <polygon points="50,10 60,40 90,40 65,60 75,90 50,70 25,90 35,60 10,40 40,40"></polygon>
  </svg>
  <span>お気に入りに追加</span>
</button>
```

最近はインタラクティブな要素としてJavaScriptを書かなくても表現できるものが増えつつあります（**現時点でクロスブラウザ対応しているかは置いておきます**）。

Popover APIを活用するとJavaScriptを使用せずポップオーバーを表示させることは可能になってきています。

```html
<button type="button" popovertarget="popover">ポップアップを表示する</button>
<div popover id="popover">ポップアップ内のコンテンツ</div>
```

更に発展させたInvokersを使うとポップオーバーのほかダイアログや開くことも可能になるように検討されています。

```html
<button type="button" invoketarget="my-dialog">ダイアログを開く</button>
<dialog id="my-dialog">ダイアログ内のコンテンツ</dialog>
```

> [Invokers (Explainer) | Open UI](https://open-ui.org/components/invokers.explainer/)

文書としてのWebページ以外にもアプリケーションとして活用されるようになってきた現代においては、様々なインタラクションの発火点として`button`要素はますます重宝されることになると思っています。だからこそインタラクションのものとして`type="button"`を明示的に書くことは重要だと考えています。

## `type`属性は今後増えていくかもしれない

`type`属性は`submit`と`button`と`reset`のみが今のHTMLの仕様で定義されていますが、今後それらが増えていく可能性があることも頭の片隅に置いておくべきだと思っています。

### Web Share API

Web Share APIとはOSの共有機能をWebブラウザから利用できるようにするAPIです。現在この機能を`button`上で実現するために`type="share"`という値が提案されています。

```html
<button type="share">共有する</button>
```

> [Share Button Type · Issue #11 · WICG/proposals](https://github.com/WICG/proposals/issues/11)

### Selectlist Element

OpenUIはW3Cコミュニティグループの１つで、組み込み用のUIコンポーネントのスタイリングや機能拡張を目的として日々活動しています。その中で`selectlist`要素というものも提案されています。

リストボックスを開くために`button`要素を使うことができて、その際に`type="selectlist"`という値が使えることが提案されています。

<figure>
  <img src="https://open-ui.org/images/selectlist-usecase-button.png" alt="The rendering of a selectlist with an author-provided button" width="320">
  <figurecaption><a href="https://open-ui.org/components/selectlist/#replacing-the-button">Replacing the button より引用</a></figurecaption>
</figure>


```html
<selectlist>
  <button type="selectlist">
    selected option: <selectedoption></selectedoption>
  </button>
  <option>one</option>
  <option>two</option>
</selectlist>
```

> [Selectlist Element (Explainer) | Open UI](https://open-ui.org/components/selectlist/)

---

これらはいずれもWeb標準の挙動としてはまだ確立されていませんが、`type`属性が３つしかないと思いこんでいると、今後増えていくことを見落としてしまうかもしれません。

## おわりに

以上`button`要素の`type`属性について書きました。

この記事を読んでそもそも`button`要素のデフォルト挙動が`submit`になっていること自体が煩わしいと感じた人もいるかもしれません。しかしWebは後方互換性を重視しているものです。これまで明示的に書いていなかったものがデフォルトの挙動を変えてしまえば何らかのサイトやアプリケーションで動かなくなってしまう可能性が大いにあります。

そうした状況の中でWebサイト・アプリケーションを作っていく上で今後も`button`要素は重要な役割を担っていくと思っています。そのためにも`type`属性を明示的に書いていくことは重要だと思っています。これまで意識して書いてなかった人もこれを機に意識して書いていけるようになってくれると嬉しいです。
